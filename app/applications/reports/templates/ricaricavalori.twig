{% extends template_extend %}

    {% block content %}

        <div id="divtabellainput">
            <div class="content_tabella">
                <div class="contenutotab">
                    <table width="100%" cellpadding="1" cellspacing="1" border="1">
                        <tr>
                            <td rowspan="2" colspan="2">Tipologia di impianto</td>
                            <td colspan="3">f<sup>*</sup><sub>H,inv,tab</sub> [-]</td>
                        </tr>
                        <tr>
                            <td>A<sup>1)</sup></td>
                            <td>B<sup>1)</sup></td>
                            <td>C<sup>1)</sup></td>
                        </tr>
                        <tr>
                            <td rowspan="4" width="22%">Impianto a distribuzione<br>verticale a colonne</td>
                            <td width="50%">Edificio ad un piano</td>
                            <td width="10%"><a href="#" class="valoreok" data-valore="0.23">0,23</a></td>
                            <td width="10%"><a href="#" class="valoreok" data-valore="0.25">0,25</a></td>
                            <td width="10%"><a href="#" class="valoreok" data-valore="0.30">0,30</a></td>
                        </tr>
                        <tr>
                            <td>Edificio a due piani</td>
                            <td><a href="#" class="valoreok" data-valore="0.22">0,22</a></td>
                            <td><a href="#" class="valoreok" data-valore="0.24">0,24</a></td>
                            <td><a href="#" class="valoreok" data-valore="0.28">0,28</a></td>
                        </tr>
                        <tr>
                            <td>Edificio a tre piani</td>
                            <td><a href="#" class="valoreok" data-valore="0.21">0,21</a></td>
                            <td><a href="#" class="valoreok" data-valore="0.23">0,23</a></td>
                            <td><a href="#" class="valoreok" data-valore="0.265">0,265</a></td>
                        </tr>
                        <tr>
                            <td>Edificio a quattro piani ed oltre</td>
                            <td><a href="#" class="valoreok" data-valore="0.20">0,20</a></td>
                            <td><a href="#" class="valoreok" data-valore="0.22">0,22</a></td>
                            <td><a href="#" class="valoreok" data-valore="0.25">0,25</a></td>
                        </tr>
                        <tr>
                            <td colspan="2">Impianto a distribuzione orizzontale con collettori complanari o monotubo <sup>2) 5)</sup></td>
                            <td colspan="3"><a href="#" class="valoreok" data-valore="0.10">0,10</a></td>
                        </tr>
                        <tr>
                            <td colspan="2">Impianto con satelliti di utenza <sup>4)</sup> con valvole a due vie modulanti e &Delta;t elevato <sup>2) 5)</sup></td>
                            <td colspan="3"><a href="#" class="valoreok" data-valore="0.10">0,10</a></td>
                        </tr>
                        <tr>
                            <td colspan="2">Impianto con satelliti di utenza <sup>4)</sup> con valvole a tre e regolazione on-off <sup>2) 5)</sup></td>
                            <td colspan="3"><a href="#" class="valoreok" data-valore="0.25">0,25</a></td>
                        </tr>
                        <tr>
                            <td colspan="2">Impianto con satelliti di utenza <sup>4)</sup> con valvole a due vie modulanti e &Delta;t elevato;<br>
                                produzione di acqua calda sanitaria con scambiatori collegati alla medesima rete <sup>3) 5)</sup></td>
                            <td colspan="3"><a href="#" class="valoreok" data-valore="0.35">0,35</a></td>
                        </tr>
                        <tr>
                            <td colspan="2">Impianto con satelliti di utenza <sup>4)</sup> con valvole a tre e regolazione on-off;<br>
                                produzione di acqua calda sanitaria con scambiatori collegati alla medesima rete <sup>3) 5)</sup></td>
                            <td colspan="3"><a href="#" class="valoreok" data-valore="0.50">0,50</a></td>
                        </tr>
                        <tr>
                            <td colspan="5" style="text-align: left;">
                                <strong>1)</strong> Stato dell'isolamento della distribuzione orizzontale corrente a soffitto del piano cantinato:<br>
                                A = eseguito con cura e protetto da uno stato di gesso, plastica o alluminio;<br>
                                B = eseguito con materiali vari (mussola di cotone, coppelle) non fissato stabilmente con strato protettivo;<br>
                                C = isolamento inesistente o gravemente deteriorato<br>
                                <strong>2)</strong> Temperatura del fluido preregolata in funzione del clima, rete per distribuzione di solo riscaldamento, rete acqua calda sanitaria indipendente.<br>
                                <strong>3)</strong> Temperatura del liquido a punto fisso per la produzione di acqua calda sanitaria con scambiatori locali.<br>
                                <strong>4)</strong> Satelliti di utenza: moduli di derivazione di zona contenenti generalmente gli organi di regolazione e contabilizzazione.<br>
                                <strong>5)</strong> In questi impianti dovrebbero essere presenti dei contatori di zona. In tal caso il consumo involontario di energia termica utile deve essere calcolato sottraendo al consumo totaleil consumo volontario totale, a sua volta determinato come sommatoria dei consumi volontari delle singole unit√† immobiliari.

                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="chiudibutt">
                <i class="far fa-times-circle"></i>
            </div>
        </div>

        <style>
            #divtabellainput{
                display: none;
                width: 100%;
                height: 100%;
                position: fixed;
                top: 0px;
                left: 0px;
                background-color: rgba(0,0,0,0.4);
            }
            #divtabellainput .content_tabella{
                width: 800px;
                height: 400px;
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-400px, -200px);
                background-color: #FFF;
                padding: 20px;
                border-radius: 30px;
                overflow: scroll;
            }

            #divtabellainput .chiudibutt {
                width: 50px;
                height: 50px;
                right: 50%;
                top: 50%;
                position: absolute;
                background-color: white;
                border-radius: 30px;
                text-align: center;
                padding-top: 6px;
                transform: translate(425px, -225px);
            }


            #divtabellainput .chiudibutt i{
                font-size:3em;
            }
            .contenutotab table tr td{
                text-align: center;
                padding: 5px 2px;
            }
            #basic-addon2{
                cursor: pointer;
            }

        </style>

        <script>
            $( document ).ready(function() {

                currentvalue = "";

                inputCondominio = $("#input_idCondominio");
                idCondominio = inputCondominio.val();
                console.log(idCondominio);

                if(idCondominio>0){
                    caricaDefaults(idCondominio);
                }


                inputCondominio.change(function() {
                    idCondominio = $(this).val();
                    if(idCondominio!=currentvalue){
                        caricaDefaults(idCondominio);
                    }
                });

                function caricaDefaults(id){
                    currentvalue = id;
                    console.log("caricaDefaults");
                    urltocall = '{{ router_service.getRoute("backend.bolletta.caricadefault").build() }}';
                    console.log(urltocall);

                    $.ajax({
                        method: "POST",
                        url: urltocall,
                        data: {
                            idCondominio: id
                        }
                    })
                        .done(function( msg ) {
                            var obj = JSON.parse(msg);

                            $.each( obj, function( key, value ) {
                                if(value!=null){
                                    $("*[name='"+key+"']").val(value).trigger('change');
                                }
                            });

                        });

                }

                $("input[name='coeff']").parent().append('<div class="input-group-append" id="tabellainput"><span class="input-group-text" id="basic-addon2">seleziona</span></div>');

                $("#tabellainput").click(function(e){
                    e.preventDefault();
                    $("#divtabellainput").fadeIn();
                });
                $(".chiudibutt").click(function(e){
                    e.preventDefault();
                    $("#divtabellainput").fadeOut();
                });

                $("a.valoreok").click(function(e){
                   e.preventDefault();
                   valore = $(this).attr("data-valore");
                    $("input[name='coeff']").val(valore);
                    $("#divtabellainput").fadeOut();
                });


            });
        </script>
{% endblock %}
